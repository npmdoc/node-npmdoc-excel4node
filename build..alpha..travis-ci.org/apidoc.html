<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/natergj/excel4node#readme"

    >excel4node (v1.2.1)</a>
</h1>
<h4>Library to create Formatted Excel Files.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.excel4node">module excel4node</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.Workbook">
            function <span class="apidocSignatureSpan">excel4node.</span>Workbook
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.getExcelAlpha">
            function <span class="apidocSignatureSpan">excel4node.</span>getExcelAlpha
            <span class="apidocSignatureSpan">(colNum)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.getExcelCellRef">
            function <span class="apidocSignatureSpan">excel4node.</span>getExcelCellRef
            <span class="apidocSignatureSpan">(rowNum, colNum)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.getExcelRowCol">
            function <span class="apidocSignatureSpan">excel4node.</span>getExcelRowCol
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.getExcelTS">
            function <span class="apidocSignatureSpan">excel4node.</span>getExcelTS
            <span class="apidocSignatureSpan">(date)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>BorderStyle</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>HorizontalAlignment</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>Orientation</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PageOrder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>Pane</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PaneState</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PaperSize</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PatternType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PositiveUniversalMeasure</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PresetColorVal</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>PrintError</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>VerticalAlignment</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>builder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>index</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.excel4node.builder">module excel4node.builder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.builder.writeToBuffer">
            function <span class="apidocSignatureSpan">excel4node.builder.</span>writeToBuffer
            <span class="apidocSignatureSpan">(wb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.excel4node.index">module excel4node.index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.index.Workbook">
            function <span class="apidocSignatureSpan">excel4node.index.</span>Workbook
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.index.getExcelAlpha">
            function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelAlpha
            <span class="apidocSignatureSpan">(colNum)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.index.getExcelCellRef">
            function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelCellRef
            <span class="apidocSignatureSpan">(rowNum, colNum)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.index.getExcelRowCol">
            function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelRowCol
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.index.getExcelTS">
            function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelTS
            <span class="apidocSignatureSpan">(date)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>BorderStyle</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>HorizontalAlignment</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>Orientation</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PageOrder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>Pane</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PaneState</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PaperSize</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PatternType</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PositiveUniversalMeasure</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PresetColorVal</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>PrintError</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">excel4node.index.</span>VerticalAlignment</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.excel4node.utils">module excel4node.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.arrayIntersectSafe">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>arrayIntersectSafe
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.boolToInt">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>boolToInt
            <span class="apidocSignatureSpan">(bool)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.generateRId">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>generateRId
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getAllCellsInExcelRange">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getAllCellsInExcelRange
            <span class="apidocSignatureSpan">(range)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getAllCellsInNumericRange">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getAllCellsInNumericRange
            <span class="apidocSignatureSpan">(row1, col1, row2, col2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getExcelAlpha">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelAlpha
            <span class="apidocSignatureSpan">(colNum)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getExcelCellRef">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelCellRef
            <span class="apidocSignatureSpan">(rowNum, colNum)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getExcelRowCol">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelRowCol
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getExcelTS">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelTS
            <span class="apidocSignatureSpan">(date)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.getHashOfPassword">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>getHashOfPassword
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel4node.utils.sortCellRefs">
            function <span class="apidocSignatureSpan">excel4node.utils.</span>sortCellRefs
            <span class="apidocSignatureSpan">(a, b)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.excel4node" id="apidoc.module.excel4node">module excel4node</a></h1>


    <h2>
        <a href="#apidoc.element.excel4node.Workbook" id="apidoc.element.excel4node.Workbook">
        function <span class="apidocSignatureSpan">excel4node.</span>Workbook
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Workbook(opts) {
    _classCallCheck(this, Workbook);

    opts = opts ? opts : {};

    this.logger = new SlothLogger.Logger({
        logLevel: Number.isNaN(parseInt(opts.logLevel)) ? 0 : parseInt(opts.logLevel)
    });

    this.opts = _.merge({}, workbookDefaultOpts, opts);

    this.sheets = [];
    this.sharedStrings = [];
    this.styles = [];
    this.stylesLookup = {};
    this.dxfCollection = new DXFCollection(this);
    this.mediaCollection = new MediaCollection();
    this.definedNameCollection = new DefinedNameCollection();
    this.styleData = {
        &#x27;numFmts&#x27;: [],
        &#x27;fonts&#x27;: [],
        &#x27;fills&#x27;: [new Fill({ type: &#x27;pattern&#x27;, patternType: &#x27;none&#x27; }), new Fill({ type: &#x27;pattern&#x27;, patternType: &#x27;gray125&#x27; })],
        &#x27;borders&#x27;: [new Border()],
        &#x27;cellXfs&#x27;: [{
            &#x27;borderId&#x27;: null,
            &#x27;fillId&#x27;: null,
            &#x27;fontId&#x27;: 0,
            &#x27;numFmtId&#x27;: null
        }]
    };

    // Lookups for style components to quickly find existing entries
    // - Lookup keys are stringified JSON of a style&#x27;s toObject result
    // - Lookup values are the indexes for the actual entry in the styleData arrays
    this.styleDataLookup = {
        &#x27;fonts&#x27;: {},
        &#x27;fills&#x27;: this.styleData.fills.reduce(function (ret, fill, index) {
            ret[JSON.stringify(fill.toObject())] = index;
            return ret;
        }, {}),
        &#x27;borders&#x27;: this.styleData.borders.reduce(function (ret, border, index) {
            ret[JSON.stringify(border.toObject())] = index;
            return ret;
        }, {})
    };

    // Set Default Font and Style
    this.createStyle({ font: this.opts.defaultFont });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

### Basic Usage
```javascript
// Require library
var xl = require(&#x27;excel4node&#x27;);

// Create a new instance of a Workbook class
var wb = new xl.<span class="apidocCodeKeywordSpan">Workbook</span>();

// Add Worksheets to the workbook
var ws = wb.addWorksheet(&#x27;Sheet 1&#x27;);
var ws2 = wb.addWorksheet(&#x27;Sheet 2&#x27;);

// Create a reusable style
var style = wb.createStyle({
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.getExcelAlpha" id="apidoc.element.excel4node.getExcelAlpha">
        function <span class="apidocSignatureSpan">excel4node.</span>getExcelAlpha
        <span class="apidocSignatureSpan">(colNum)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelAlpha(colNum) {
    var remaining = colNum;
    var aCharCode = 65;
    var columnName = &#x27;&#x27;;
    while (remaining &#x3e; 0) {
        var mod = (remaining - 1) % 26;
        columnName = String.fromCharCode(aCharCode + mod) + columnName;
        remaining = (remaining - 1 - mod) / 26;
    }
    return columnName;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts cell reference (i.e. &#x27;A1&#x27;) and returns object with corresponding row and column

```javascript
xl.getExcelRowCol(&#x27;B5&#x27;);
// returns { row: 5, col: 2}
```

xl.<span class="apidocCodeKeywordSpan">getExcelAlpha</span>(column)
Accepts column as integer and returns corresponding column reference as alpha

```javascript
xl.getExcelAlpha(10);
// returns &#x27;J&#x27;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.getExcelCellRef" id="apidoc.element.excel4node.getExcelCellRef">
        function <span class="apidocSignatureSpan">excel4node.</span>getExcelCellRef
        <span class="apidocSignatureSpan">(rowNum, colNum)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelCellRef(rowNum, colNum) {
    var remaining = colNum;
    var aCharCode = 65;
    var columnName = &#x27;&#x27;;
    while (remaining &#x3e; 0) {
        var mod = (remaining - 1) % 26;
        columnName = String.fromCharCode(aCharCode + mod) + columnName;
        remaining = (remaining - 1 - mod) / 26;
    }
    return columnName + rowNum;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts column as integer and returns corresponding column reference as alpha

```javascript
xl.getExcelAlpha(10);
// returns &#x27;J&#x27;
```

xl.<span class="apidocCodeKeywordSpan">getExcelCellRef</span>(row, column)
Accepts row and column as integers and returns Excel cell reference

```javascript
xl.getExcelCellRef(5, 3);
// returns &#x27;C5&#x27;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.getExcelRowCol" id="apidoc.element.excel4node.getExcelRowCol">
        function <span class="apidocSignatureSpan">excel4node.</span>getExcelRowCol
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelRowCol(str) {
    var numeric = str.split(/\D/).filter(function (el) {
        return el !== &#x27;&#x27;;
    })[0];
    var alpha = str.split(/\d/).filter(function (el) {
        return el !== &#x27;&#x27;;
    })[0];
    var row = parseInt(numeric, 10);
    var col = alpha.toUpperCase().split(&#x27;&#x27;).reduce(function (a, b, index, arr) {
        return a + (b.charCodeAt(0) - 64) * Math.pow(26, arr.length - index - 1);
    }, 0);
    return { row: row, col: col };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
ws.cell(3,1).bool(true).style(style).style({font: {size: 14}});

wb.write(&#x27;Excel.xlsx&#x27;);
```
## excelnode
excel4node comes with some generic functions and types

xl.<span class="apidocCodeKeywordSpan">getExcelRowCol</span>(cellRef)
Accepts cell reference (i.e. &#x27;A1&#x27;) and returns object with corresponding row and column

```javascript
xl.getExcelRowCol(&#x27;B5&#x27;);
// returns { row: 5, col: 2}
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.getExcelTS" id="apidoc.element.excel4node.getExcelTS">
        function <span class="apidocSignatureSpan">excel4node.</span>getExcelTS
        <span class="apidocSignatureSpan">(date)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelTS(date) {

    var thisDt = new Date(date);
    thisDt.setDate(thisDt.getDate() + 1);
    // Take timezone into account when calculating date
    thisDt.setMinutes(thisDt.getMinutes() - thisDt.getTimezoneOffset());

    var epoch = new Date(1899, 11, 31);
    // Take timezone into account when calculating epoch
    epoch.setMinutes(epoch.getMinutes() - epoch.getTimezoneOffset());

    // Get milliseconds between date sent to function and epoch
    var diff2 = thisDt.getTime() - epoch.getTime();

    var ts = diff2 / (1000 * 60 * 60 * 24);
    return ts;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts row and column as integers and returns Excel cell reference

```javascript
xl.getExcelCellRef(5, 3);
// returns &#x27;C5&#x27;
```

xl.<span class="apidocCodeKeywordSpan">getExcelTS</span>(date)
Accepts Date object and returns an Excel timestamp

```javascript
var newDate = new Date(&#x27;2015-01-01T00:00:00.0000Z&#x27;);
xl.getExcelTS(newDate);
// Returns 42004.791666666664
```
...</pre></li>
    </ul>
































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.excel4node.builder" id="apidoc.module.excel4node.builder">module excel4node.builder</a></h1>


    <h2>
        <a href="#apidoc.element.excel4node.builder.writeToBuffer" id="apidoc.element.excel4node.builder.writeToBuffer">
        function <span class="apidocSignatureSpan">excel4node.builder.</span>writeToBuffer
        <span class="apidocSignatureSpan">(wb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function writeToBuffer(wb) {
    return new Promise(function (resolve, reject) {
        var promiseObj = {
            wb: wb,
            xlsx: new JSZip(),
            xmlOutVars: {}
        };

        if (promiseObj.wb.sheets.length === 0) {
            promiseObj.wb.WorkSheet();
        }

        addRootContentTypesXML(promiseObj).then(addWorkSheetsXML).then(addRootRelsXML).then(addWorkBookXML).then(addWorkBookRelsXML
).then(addSharedStringsXML).then(addStylesXML).then(addDrawingsXML).then(function () {
            wb.opts.jszip.type = &#x27;nodebuffer&#x27;;
            promiseObj.xlsx.generateAsync(wb.opts.jszip).then(function (buf) {
                resolve(buf);
            }).catch(function (e) {
                reject(e);
            });
        }).catch(function (e) {
            wb.logger.error(e.stack);
            reject(e);
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    wb.write(&#x27;ExcelFile.xlsx&#x27;, res);
});
app.listen(3000, function () {
  console.log(&#x27;Example app listening on port 3000!&#x27;);
});
```

wb.<span class="apidocCodeKeywordSpan">writeToBuffer</span>();
The writeToBuffer() method access no parameters and returns a promise that resolves with the nodebuffer generated by the JSZip library
. This buffer can then be sent to other streams.

```javascript
var xl = require(&#x27;excel4node&#x27;);
var wb = new xl.Workbook();

wb.writeToBuffer().then(function (buffer) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.excel4node.index" id="apidoc.module.excel4node.index">module excel4node.index</a></h1>


    <h2>
        <a href="#apidoc.element.excel4node.index.Workbook" id="apidoc.element.excel4node.index.Workbook">
        function <span class="apidocSignatureSpan">excel4node.index.</span>Workbook
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">class Workbook {

<span class="apidocCodeCommentSpan">    /**
     * @class Workbook
     * @param {Object} opts Workbook settings
     * @param {Object} opts.jszip
     * @param {String} opts.jszip.compression JSZip compression type. defaults to &#x27;DEFLATE&#x27;
     * @param {Object} opts.defaultFont
     * @param {String} opts.defaultFont.color HEX value of default font color. defaults to #000000
     * @param {String} opts.defaultFont.name Font name. defaults to Calibri
     * @param {Number} opts.defaultFont.size Font size. defaults to 12
     * @param {String} opts.defaultFont.family Font family. defaults to roman
     * @param {String} opts.dataFormat Specifies the format for dates in the Workbook. defaults to &#x27;m/d/yy&#x27;
     * @returns {Workbook}
     */
</span>    constructor(opts) {
        opts = opts ? opts : {};

        this.logger = new SlothLogger.Logger({
            logLevel: Number.isNaN(parseInt(opts.logLevel)) ? 0 : parseInt(opts.logLevel)
        });

        this.opts = _.merge({}, workbookDefaultOpts, opts);

        this.sheets = [];
        this.sharedStrings = [];
        this.styles = [];
        this.stylesLookup = {};
        this.dxfCollection = new DXFCollection(this);
        this.mediaCollection = new MediaCollection();
        this.definedNameCollection = new DefinedNameCollection();
        this.styleData = {
            &#x27;numFmts&#x27;: [],
            &#x27;fonts&#x27;: [],
            &#x27;fills&#x27;: [new Fill({ type: &#x27;pattern&#x27;, patternType: &#x27;none&#x27; }), new Fill({ type: &#x27;pattern&#x27;, patternType: &#x27;gray125&#x27; })],
            &#x27;borders&#x27;: [new Border()],
            &#x27;cellXfs&#x27;: [
                {
                    &#x27;borderId&#x27;: null,
                    &#x27;fillId&#x27;: null,
                    &#x27;fontId&#x27;: 0,
                    &#x27;numFmtId&#x27;: null
                }
            ]
        };

        // Lookups for style components to quickly find existing entries
        // - Lookup keys are stringified JSON of a style&#x27;s toObject result
        // - Lookup values are the indexes for the actual entry in the styleData arrays
        this.styleDataLookup = {
            &#x27;fonts&#x27;: {},
            &#x27;fills&#x27;: this.styleData.fills.reduce((ret, fill, index) =&#x3e; {
                ret[JSON.stringify(fill.toObject())] = index;
                return ret;
            }, {}),
            &#x27;borders&#x27;: this.styleData.borders.reduce((ret, border, index) =&#x3e; {
                ret[JSON.stringify(border.toObject())] = index;
                return ret;
            }, {})
        };

        // Set Default Font and Style
        this.createStyle({ font: this.opts.defaultFont });

    }

    /**
     * setSelectedTab
     * @param {Number} tab number of sheet that should be displayed when workbook opens. tabs are indexed starting with 1
     **/
    setSelectedTab(id) {
        this.sheets.forEach((s) =&#x3e; {
            if (s.sheetId === id) {
                s.opts.sheetView.tabSelected = 1;
            } else {
                s.opts.sheetView.tabSelected = 0;
            }
        });
    }

    /**
     * writeToBuffer
     * Writes Excel data to a node Buffer.
     */
    writeToBuffer() {
        return builder.writeToBuffer(this);
    }

    /**
     * Generate .xlsx file.
     * @param {String} fileName Name of Excel workbook with .xslx extension
     * @param {http.response | callback} http response object or callback function (optional).
     * If http response object is given, file is written to http response. Useful for web applications.
     * If callback is given, callback called with (err, fs.Stats) passed
     */
    write(fileName, handler) {

        builder.writeToBuffer(this)
        .then((buffer) =&#x3e; {
            switch (typeof handler) {
                // handler passed as http response object.

            case &#x27;object&#x27;:
                if (handler instanceof http.ServerResponse) {
                    handler.writeHead(200, {
                        &#x27;Content-Length&#x27;: buffer.length,
                        &#x27;Content-Type&#x27;: &#x27;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#x27;,
                        &#x27;Content-Disposition&#x27;: &#x27;attachment; filename=&#x22;&#x27; + fileName + &#x27;&#x22;&#x27; ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

### Basic Usage
```javascript
// Require library
var xl = require(&#x27;excel4node&#x27;);

// Create a new instance of a Workbook class
var wb = new xl.<span class="apidocCodeKeywordSpan">Workbook</span>();

// Add Worksheets to the workbook
var ws = wb.addWorksheet(&#x27;Sheet 1&#x27;);
var ws2 = wb.addWorksheet(&#x27;Sheet 2&#x27;);

// Create a reusable style
var style = wb.createStyle({
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.index.getExcelAlpha" id="apidoc.element.excel4node.index.getExcelAlpha">
        function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelAlpha
        <span class="apidocSignatureSpan">(colNum)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">(colNum) =&#x3e; {
    let remaining = colNum;
    let aCharCode = 65;
    let columnName = &#x27;&#x27;;
    while (remaining &#x3e; 0) {
        let mod = (remaining - 1) % 26;
        columnName = String.fromCharCode(aCharCode + mod) + columnName;
        remaining = (remaining - 1 - mod) / 26;
    }
    return columnName;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts cell reference (i.e. &#x27;A1&#x27;) and returns object with corresponding row and column

```javascript
xl.getExcelRowCol(&#x27;B5&#x27;);
// returns { row: 5, col: 2}
```

xl.<span class="apidocCodeKeywordSpan">getExcelAlpha</span>(column)
Accepts column as integer and returns corresponding column reference as alpha

```javascript
xl.getExcelAlpha(10);
// returns &#x27;J&#x27;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.index.getExcelCellRef" id="apidoc.element.excel4node.index.getExcelCellRef">
        function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelCellRef
        <span class="apidocSignatureSpan">(rowNum, colNum)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">(rowNum, colNum) =&#x3e; {
    let remaining = colNum;
    let aCharCode = 65;
    let columnName = &#x27;&#x27;;
    while (remaining &#x3e; 0) {
        let mod = (remaining - 1) % 26;
        columnName = String.fromCharCode(aCharCode + mod) + columnName;
        remaining = (remaining - 1 - mod) / 26;
    }
    return columnName + rowNum;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts column as integer and returns corresponding column reference as alpha

```javascript
xl.getExcelAlpha(10);
// returns &#x27;J&#x27;
```

xl.<span class="apidocCodeKeywordSpan">getExcelCellRef</span>(row, column)
Accepts row and column as integers and returns Excel cell reference

```javascript
xl.getExcelCellRef(5, 3);
// returns &#x27;C5&#x27;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.index.getExcelRowCol" id="apidoc.element.excel4node.index.getExcelRowCol">
        function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelRowCol
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">(str) =&#x3e; {
    let numeric = str.split(/\D/).filter(function (el) {
        return el !== &#x27;&#x27;;
    })[0];
    let alpha = str.split(/\d/).filter(function (el) {
        return el !== &#x27;&#x27;;
    })[0];
    let row = parseInt(numeric, 10);
    let col = alpha.toUpperCase().split(&#x27;&#x27;).reduce(function (a, b, index, arr) {
        return a + (b.charCodeAt(0) - 64) * Math.pow(26, arr.length - index - 1);
    }, 0);
    return { row: row, col: col };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
ws.cell(3,1).bool(true).style(style).style({font: {size: 14}});

wb.write(&#x27;Excel.xlsx&#x27;);
```
## excelnode
excel4node comes with some generic functions and types

xl.<span class="apidocCodeKeywordSpan">getExcelRowCol</span>(cellRef)
Accepts cell reference (i.e. &#x27;A1&#x27;) and returns object with corresponding row and column

```javascript
xl.getExcelRowCol(&#x27;B5&#x27;);
// returns { row: 5, col: 2}
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.index.getExcelTS" id="apidoc.element.excel4node.index.getExcelTS">
        function <span class="apidocSignatureSpan">excel4node.index.</span>getExcelTS
        <span class="apidocSignatureSpan">(date)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">(date) =&#x3e; {

    let thisDt = new Date(date);
    thisDt.setDate(thisDt.getDate() + 1);
    // Take timezone into account when calculating date
    thisDt.setMinutes(thisDt.getMinutes() - thisDt.getTimezoneOffset());

    let epoch = new Date(1899, 11, 31);
    // Take timezone into account when calculating epoch
    epoch.setMinutes(epoch.getMinutes() - epoch.getTimezoneOffset());

    // Get milliseconds between date sent to function and epoch
    let diff2 = thisDt.getTime() - epoch.getTime();

    let ts = diff2 / (1000 * 60 * 60 * 24);
    return ts;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts row and column as integers and returns Excel cell reference

```javascript
xl.getExcelCellRef(5, 3);
// returns &#x27;C5&#x27;
```

xl.<span class="apidocCodeKeywordSpan">getExcelTS</span>(date)
Accepts Date object and returns an Excel timestamp

```javascript
var newDate = new Date(&#x27;2015-01-01T00:00:00.0000Z&#x27;);
xl.getExcelTS(newDate);
// Returns 42004.791666666664
```
...</pre></li>
    </ul>


























</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.excel4node.utils" id="apidoc.module.excel4node.utils">module excel4node.utils</a></h1>


    <h2>
        <a href="#apidoc.element.excel4node.utils.arrayIntersectSafe" id="apidoc.element.excel4node.utils.arrayIntersectSafe">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>arrayIntersectSafe
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function arrayIntersectSafe(a, b) {

    if (a instanceof Array &#x26;&#x26; b instanceof Array) {
        var ai = 0,
            bi = 0;
        var result = new Array();

        while (ai &#x3c; a.length &#x26;&#x26; bi &#x3c; b.length) {
            if (a[ai] &#x3c; b[bi]) {
                ai++;
            } else if (a[ai] &#x3e; b[bi]) {
                bi++;
            } else {
                result.push(a[ai]);
                ai++;
                bi++;
            }
        }
        return result;
    } else {
        throw new TypeError(&#x27;Both variables sent to arrayIntersectSafe must be arrays&#x27;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var cellRange = excelRefs[0] + &#x27;:&#x27; + excelRefs[excelRefs.length - 1];
var rangeCells = excelRefs;

var okToMerge = true;
cellBlock.ws.mergedCells.forEach(function (cr) {
    // Check to see if currently merged cells contain cells in new merge request
    var curCells = utils.getAllCellsInExcelRange(cr);
    var intersection = utils.<span class="apidocCodeKeywordSpan">arrayIntersectSafe</span>(rangeCells, curCells);
    if (intersection.length &#x3e; 0) {
        okToMerge = false;
        cellBlock.ws.wb.logger.error(&#x27;Invalid Range for: &#x27; + cellRange + &#x27;. Some cells in this range are already
included in another merged cell range: &#x27; + cr + &#x27;.&#x27;);
    }
});
if (okToMerge) {
    cellBlock.ws.mergedCells.push(cellRange);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.boolToInt" id="apidoc.element.excel4node.utils.boolToInt">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>boolToInt
        <span class="apidocSignatureSpan">(bool)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function boolToInt(bool) {
    if (bool === true) {
        return 1;
    }
    if (bool === false) {
        return 0;
    }
    if (parseInt(bool) === 1) {
        return 1;
    }
    if (parseInt(bool) === 0) {
        return 0;
    }
    throw new TypeError(&#x27;Value sent to boolToInt must be true, false, 1 or 0&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.generateRId" id="apidoc.element.excel4node.utils.generateRId">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>generateRId
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function generateRId() {
    var text = &#x27;R&#x27;;
    var possible = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;;
    for (var i = 0; i &#x3c; 16; i++) {
        text += possible.charAt(Math.floor(Math.random() * possible.length));
    }
    return text;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getAllCellsInExcelRange" id="apidoc.element.excel4node.utils.getAllCellsInExcelRange">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getAllCellsInExcelRange
        <span class="apidocSignatureSpan">(range)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getAllCellsInExcelRange(range) {
    var cells = range.split(&#x27;:&#x27;);
    var cell1props = getExcelRowCol(cells[0]);
    var cell2props = getExcelRowCol(cells[1]);
    return getAllCellsInNumericRange(cell1props.row, cell1props.col, cell2props.row, cell2props.col);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var cellRange = excelRefs[0] + &#x27;:&#x27; + excelRefs[excelRefs.length - 1];
var rangeCells = excelRefs;

var okToMerge = true;
cellBlock.ws.mergedCells.forEach(function (cr) {
    // Check to see if currently merged cells contain cells in new merge request
    var curCells = utils.<span class="apidocCodeKeywordSpan">getAllCellsInExcelRange</span>(cr);
    var intersection = utils.arrayIntersectSafe(rangeCells, curCells);
    if (intersection.length &#x3e; 0) {
        okToMerge = false;
        cellBlock.ws.wb.logger.error(&#x27;Invalid Range for: &#x27; + cellRange + &#x27;. Some cells in this range are already
included in another merged cell range: &#x27; + cr + &#x27;.&#x27;);
    }
});
if (okToMerge) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getAllCellsInNumericRange" id="apidoc.element.excel4node.utils.getAllCellsInNumericRange">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getAllCellsInNumericRange
        <span class="apidocSignatureSpan">(row1, col1, row2, col2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getAllCellsInNumericRange(row1, col1, row2, col2) {
    var response = [];
    row2 = row2 ? row2 : row1;
    col2 = col2 ? col2 : col1;
    for (var i = row1; i &#x3c;= row2; i++) {
        for (var j = col1; j &#x3c;= col2; j++) {
            response.push(getExcelAlpha(j) + i);
        }
    }
    return response.sort(sortCellRefs);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getExcelAlpha" id="apidoc.element.excel4node.utils.getExcelAlpha">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelAlpha
        <span class="apidocSignatureSpan">(colNum)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelAlpha(colNum) {
    var remaining = colNum;
    var aCharCode = 65;
    var columnName = &#x27;&#x27;;
    while (remaining &#x3e; 0) {
        var mod = (remaining - 1) % 26;
        columnName = String.fromCharCode(aCharCode + mod) + columnName;
        remaining = (remaining - 1 - mod) / 26;
    }
    return columnName;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts cell reference (i.e. &#x27;A1&#x27;) and returns object with corresponding row and column

```javascript
xl.getExcelRowCol(&#x27;B5&#x27;);
// returns { row: 5, col: 2}
```

xl.<span class="apidocCodeKeywordSpan">getExcelAlpha</span>(column)
Accepts column as integer and returns corresponding column reference as alpha

```javascript
xl.getExcelAlpha(10);
// returns &#x27;J&#x27;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getExcelCellRef" id="apidoc.element.excel4node.utils.getExcelCellRef">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelCellRef
        <span class="apidocSignatureSpan">(rowNum, colNum)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelCellRef(rowNum, colNum) {
    var remaining = colNum;
    var aCharCode = 65;
    var columnName = &#x27;&#x27;;
    while (remaining &#x3e; 0) {
        var mod = (remaining - 1) % 26;
        columnName = String.fromCharCode(aCharCode + mod) + columnName;
        remaining = (remaining - 1 - mod) / 26;
    }
    return columnName + rowNum;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts column as integer and returns corresponding column reference as alpha

```javascript
xl.getExcelAlpha(10);
// returns &#x27;J&#x27;
```

xl.<span class="apidocCodeKeywordSpan">getExcelCellRef</span>(row, column)
Accepts row and column as integers and returns Excel cell reference

```javascript
xl.getExcelCellRef(5, 3);
// returns &#x27;C5&#x27;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getExcelRowCol" id="apidoc.element.excel4node.utils.getExcelRowCol">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelRowCol
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelRowCol(str) {
    var numeric = str.split(/\D/).filter(function (el) {
        return el !== &#x27;&#x27;;
    })[0];
    var alpha = str.split(/\d/).filter(function (el) {
        return el !== &#x27;&#x27;;
    })[0];
    var row = parseInt(numeric, 10);
    var col = alpha.toUpperCase().split(&#x27;&#x27;).reduce(function (a, b, index, arr) {
        return a + (b.charCodeAt(0) - 64) * Math.pow(26, arr.length - index - 1);
    }, 0);
    return { row: row, col: col };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
ws.cell(3,1).bool(true).style(style).style({font: {size: 14}});

wb.write(&#x27;Excel.xlsx&#x27;);
```
## excelnode
excel4node comes with some generic functions and types

xl.<span class="apidocCodeKeywordSpan">getExcelRowCol</span>(cellRef)
Accepts cell reference (i.e. &#x27;A1&#x27;) and returns object with corresponding row and column

```javascript
xl.getExcelRowCol(&#x27;B5&#x27;);
// returns { row: 5, col: 2}
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getExcelTS" id="apidoc.element.excel4node.utils.getExcelTS">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getExcelTS
        <span class="apidocSignatureSpan">(date)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExcelTS(date) {

    var thisDt = new Date(date);
    thisDt.setDate(thisDt.getDate() + 1);
    // Take timezone into account when calculating date
    thisDt.setMinutes(thisDt.getMinutes() - thisDt.getTimezoneOffset());

    var epoch = new Date(1899, 11, 31);
    // Take timezone into account when calculating epoch
    epoch.setMinutes(epoch.getMinutes() - epoch.getTimezoneOffset());

    // Get milliseconds between date sent to function and epoch
    var diff2 = thisDt.getTime() - epoch.getTime();

    var ts = diff2 / (1000 * 60 * 60 * 24);
    return ts;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Accepts row and column as integers and returns Excel cell reference

```javascript
xl.getExcelCellRef(5, 3);
// returns &#x27;C5&#x27;
```

xl.<span class="apidocCodeKeywordSpan">getExcelTS</span>(date)
Accepts Date object and returns an Excel timestamp

```javascript
var newDate = new Date(&#x27;2015-01-01T00:00:00.0000Z&#x27;);
xl.getExcelTS(newDate);
// Returns 42004.791666666664
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.getHashOfPassword" id="apidoc.element.excel4node.utils.getHashOfPassword">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>getHashOfPassword
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getHashOfPassword(str) {
    var curHash = &#x27;0000&#x27;;
    for (var i = str.length - 1; i &#x3e;= 0; i--) {
        curHash = _getHashForChar(str[i], curHash);
    }
    var curHashBin = parseInt(curHash, 16).toString(2);
    var charCountBin = parseInt(str.length, 10).toString(2);
    var saltBin = parseInt(&#x27;CE4B&#x27;, 16).toString(2);

    var firstXOR = _bitXOR(curHashBin, charCountBin);
    var finalHashBin = _bitXOR(firstXOR, saltBin);
    var finalHash = String(&#x27;0000&#x27; + parseInt(finalHashBin, 2).toString(16).toUpperCase()).slice(-4);

    return finalHash;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel4node.utils.sortCellRefs" id="apidoc.element.excel4node.utils.sortCellRefs">
        function <span class="apidocSignatureSpan">excel4node.utils.</span>sortCellRefs
        <span class="apidocSignatureSpan">(a, b)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sortCellRefs(a, b) {
    var aAtt = getExcelRowCol(a);
    var bAtt = getExcelRowCol(b);
    if (aAtt.col === bAtt.col) {
        return aAtt.row - bAtt.row;
    } else {
        return aAtt.col - bAtt.col;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
